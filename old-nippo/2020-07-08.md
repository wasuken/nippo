# 日報(2020-07-08)

カフェでがんばるぞい。

## 今日やったこと

### ブログシステム

#### 作業ログ

##### 15:02:39

各パラメータの基本的なテストを追加した。

##### 15:22:50

そこそこ実用的な?テストを追加したら一度デプロイすることに決めた。

##### 16:02:51

しょっぼいテスト書いて満足したのでpushした。

ビルド通ったら手動デプロイする。

##### 17:35:10

デプロイ完了。

時間がかかったり理由は、エラーアンドエラーです(半ギレ)。

記事参照ページ(page?id=みたいなURLのとこ)内のリンクを修正し、

さらにはトップページでgetパラメタをいれて開いた時に、

パラメタを読み込んで、検索結果に反映させるということをした。

でもそうすると例えば上記のようなルートでトップページにたどり着いたあと

別の検索条件で検索すると、URLのパラメタを引きずるよねってなって確認したらやっぱりそうだった。

なのでそのバグを修正したりして、終わり。

##### 19:44:54

記事更新APIも実装した。

そして今気がついたが、RSSの機能消してしまったので(誰も使ってないだろうが)、

書き直すことにした。

##### 20:09:17

記事更新APIを実装して、CI通して、デプロイした。

#### メモ

##### APIのレスポンスボディについて

Validationエラー発生時にはstatusとerrorsをいれたJSONを返してるんだけど、

成功時のresponseにもstatusは入れたほうがいいのかな。

そしてエラー時にはn秒後に再取得とか、どんなエラーがでてるかをstoreで管理して、

それをどっかにこっそり表示するみたいなものにするべきか？

##### 追加テストについて

基本的なテストはパパッといれたけど、

データの内容的のチェックみたいなテストはいれてない。

たとえば、きちんとソートされてるとか、

ページング処理はうまくできてるとかやったほうがいいのではないだろうか。

途中で気がついたけど、今はパラメタ一つずつのテストしかしてないんだけど、

例えば、qとtagをいれて、結果が正しくでているとかのテストもいると思った。

###### API経由での記事更新機能の実装

わたし「やれ」

わたし「はい」

ログイン時に投稿するためのページを再利用する形で更新する処理もできるようにすることもできるだろうけど、

あまり使わんし、こっちは後回しでも良いと思う。

###### まともな検索エンジンの実装

今Grepなんすよ...。まあこのクソサイトの訪問者少ないから別段問題はないけど、

楽しそうだからやる。あとPHPで検索エンジン実装してみるって発言覚えてるから、反故にしたくないってのもある。

このシステムの中では結構でかいタスクなので、

他の優先度高いタスクを終えたあと

一つの塊(ロジック設計->テーブル設計->テーブル追加->部品実装->部品テスト->Controllerに追加->テスト)

として処理したい。正直これ実装してる時に他のバグとごっちゃになるのはきつい。

## 次やること

ブログシステムの検索エンジンに取りかかりたいね。
